<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Theora (theora.Theora)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">theora</a> &#x00BB; Theora</nav><header class="odoc-preamble"><h1>Module <code><span>Theora</span></code></h1><p>* Functions for encoding theora files using libtheora. * * </p><ul class="at-tags"><li class="author"><span class="at-tag">author</span> Samuel Mimram</li></ul><p>* </p><ul class="at-tags"><li class="author"><span class="at-tag">author</span> Romain Beauxis</li></ul></header><nav class="odoc-toc"><ul><li><a href="#exceptions">Exceptions</a></li><li><a href="#general-functions">General functions</a></li><li><a href="#types-and-datastructures">Types and datastructures</a></li><li><a href="#encoding">Encoding</a></li></ul></nav><div class="odoc-content"><h3 id="exceptions"><a href="#exceptions" class="anchor"></a>Exceptions</h3><div class="odoc-spec"><div class="spec exception anchored" id="exception-Internal_error"><a href="#exception-Internal_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Internal_error</span></span></code></div><div class="spec-doc"><p>General failure.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Invalid_data"><a href="#exception-Invalid_data" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Invalid_data</span></span></code></div><div class="spec-doc"><p>Library encountered invalid internal data.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Unknown_error"><a href="#exception-Unknown_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Unknown_error</span> <span class="keyword">of</span> int</span></code></div><div class="spec-doc"><p>An unhandled error happened.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Duplicate_frame"><a href="#exception-Duplicate_frame" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Duplicate_frame</span></span></code></div><div class="spec-doc"><p>The decoded packet represented a dropped frame. * The player can continue to display the current frame, * as the contents of the decoded frame buffer have not * changed.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Done"><a href="#exception-Done" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Done</span></span></code></div><div class="spec-doc"><p>Exceptions used by the decoding module.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Not_initialized"><a href="#exception-Not_initialized" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Not_initialized</span></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Bad_packet"><a href="#exception-Bad_packet" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Bad_packet</span></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Header_not_theora"><a href="#exception-Header_not_theora" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Header_not_theora</span></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Bad_header"><a href="#exception-Bad_header" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Bad_header</span></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Not_implemented"><a href="#exception-Not_implemented" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Not_implemented</span></span></code></div></div><h3 id="general-functions"><a href="#general-functions" class="anchor"></a>General functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-version_string"><a href="#val-version_string" class="anchor"></a><code><span><span class="keyword">val</span> version_string : string</span></code></div><div class="spec-doc"><p>* Human-readable string to identify the encoder vendor and version.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-version_number"><a href="#val-version_number" class="anchor"></a><code><span><span class="keyword">val</span> version_number : int * int * int</span></code></div><div class="spec-doc"><p>major, minor and sub version numbers of the encoder.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_keyframe"><a href="#val-is_keyframe" class="anchor"></a><code><span><span class="keyword">val</span> is_keyframe : <span><a href="../../ogg/Ogg/Stream/index.html#type-packet">Ogg.Stream.packet</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Determines whether a theora packet is a key frame or not. * * raises <code>Invalid_data</code> if The packet is not a video data * packet.</p></div></div><h3 id="types-and-datastructures"><a href="#types-and-datastructures" class="anchor"></a>Types and datastructures</h3><div class="odoc-spec"><div class="spec type anchored" id="type-colorspace"><a href="#type-colorspace" class="anchor"></a><code><span><span class="keyword">type</span> colorspace</span><span> = </span></code><ol><li id="type-colorspace.CS_unspecified" class="def variant constructor anchored"><a href="#type-colorspace.CS_unspecified" class="anchor"></a><code><span>| </span><span><span class="constructor">CS_unspecified</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The colorspace is unknown or unspecified</p><span class="comment-delim">*)</span></div></li><li id="type-colorspace.CS_ITU_REC_470M" class="def variant constructor anchored"><a href="#type-colorspace.CS_ITU_REC_470M" class="anchor"></a><code><span>| </span><span><span class="constructor">CS_ITU_REC_470M</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>This is the best option for 'NTSC' content</p><span class="comment-delim">*)</span></div></li><li id="type-colorspace.CS_ITU_REC_470BG" class="def variant constructor anchored"><a href="#type-colorspace.CS_ITU_REC_470BG" class="anchor"></a><code><span>| </span><span><span class="constructor">CS_ITU_REC_470BG</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>This is the best option for 'PAL' content</p><span class="comment-delim">*)</span></div></li><li id="type-colorspace.CS_NSPACES" class="def variant constructor anchored"><a href="#type-colorspace.CS_NSPACES" class="anchor"></a><code><span>| </span><span><span class="constructor">CS_NSPACES</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>This marks the end of the defined colorspaces</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>A Colorspace.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-pixelformat"><a href="#type-pixelformat" class="anchor"></a><code><span><span class="keyword">type</span> pixelformat</span><span> = </span></code><ol><li id="type-pixelformat.PF_420" class="def variant constructor anchored"><a href="#type-pixelformat.PF_420" class="anchor"></a><code><span>| </span><span><span class="constructor">PF_420</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Chroma subsampling by 2 in each direction (4:2:0)</p><span class="comment-delim">*)</span></div></li><li id="type-pixelformat.PF_reserved" class="def variant constructor anchored"><a href="#type-pixelformat.PF_reserved" class="anchor"></a><code><span>| </span><span><span class="constructor">PF_reserved</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Reserved value</p><span class="comment-delim">*)</span></div></li><li id="type-pixelformat.PF_422" class="def variant constructor anchored"><a href="#type-pixelformat.PF_422" class="anchor"></a><code><span>| </span><span><span class="constructor">PF_422</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Horizonatal chroma subsampling by 2 (4:2:2)</p><span class="comment-delim">*)</span></div></li><li id="type-pixelformat.PF_444" class="def variant constructor anchored"><a href="#type-pixelformat.PF_444" class="anchor"></a><code><span>| </span><span><span class="constructor">PF_444</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>No chroma subsampling at all (4:4:4)</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>* A Chroma subsampling * * These enumerate the available chroma subsampling options supported * by the theora format. See Section 4.4 of the specification for * exact definitions.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-info"><a href="#type-info" class="anchor"></a><code><span><span class="keyword">type</span> info</span><span> = </span><span>{</span></code><ol><li id="type-info.frame_width" class="def record field anchored"><a href="#type-info.frame_width" class="anchor"></a><code><span>frame_width : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The encoded frame width.</p><span class="comment-delim">*)</span></div></li><li id="type-info.frame_height" class="def record field anchored"><a href="#type-info.frame_height" class="anchor"></a><code><span>frame_height : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The encoded frame height.</p><span class="comment-delim">*)</span></div></li><li id="type-info.picture_width" class="def record field anchored"><a href="#type-info.picture_width" class="anchor"></a><code><span>picture_width : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The displayed picture width.</p><span class="comment-delim">*)</span></div></li><li id="type-info.picture_height" class="def record field anchored"><a href="#type-info.picture_height" class="anchor"></a><code><span>picture_height : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The displayed picture height.</p><span class="comment-delim">*)</span></div></li><li id="type-info.picture_x" class="def record field anchored"><a href="#type-info.picture_x" class="anchor"></a><code><span>picture_x : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The X offset of the displayed picture.</p><span class="comment-delim">*)</span></div></li><li id="type-info.picture_y" class="def record field anchored"><a href="#type-info.picture_y" class="anchor"></a><code><span>picture_y : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The Y offset of the displayed picture.</p><span class="comment-delim">*)</span></div></li><li id="type-info.colorspace" class="def record field anchored"><a href="#type-info.colorspace" class="anchor"></a><code><span>colorspace : <a href="#type-colorspace">colorspace</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The color space.</p><span class="comment-delim">*)</span></div></li><li id="type-info.pixel_fmt" class="def record field anchored"><a href="#type-info.pixel_fmt" class="anchor"></a><code><span>pixel_fmt : <a href="#type-pixelformat">pixelformat</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The pixel format.</p><span class="comment-delim">*)</span></div></li><li id="type-info.target_bitrate" class="def record field anchored"><a href="#type-info.target_bitrate" class="anchor"></a><code><span>target_bitrate : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The target bit-rate in bits per second.</p><span class="comment-delim">*)</span></div></li><li id="type-info.quality" class="def record field anchored"><a href="#type-info.quality" class="anchor"></a><code><span>quality : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The target quality level.</p><span class="comment-delim">*)</span></div></li><li id="type-info.keyframe_granule_shift" class="def record field anchored"><a href="#type-info.keyframe_granule_shift" class="anchor"></a><code><span>keyframe_granule_shift : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The amount to shift to extract the last keyframe number from the granule position.</p><span class="comment-delim">*)</span></div></li><li id="type-info.version_major" class="def record field anchored"><a href="#type-info.version_major" class="anchor"></a><code><span>version_major : int;</span></code></li><li id="type-info.version_minor" class="def record field anchored"><a href="#type-info.version_minor" class="anchor"></a><code><span>version_minor : int;</span></code></li><li id="type-info.version_subminor" class="def record field anchored"><a href="#type-info.version_subminor" class="anchor"></a><code><span>version_subminor : int;</span></code></li><li id="type-info.fps_numerator" class="def record field anchored"><a href="#type-info.fps_numerator" class="anchor"></a><code><span>fps_numerator : int;</span></code></li><li id="type-info.fps_denominator" class="def record field anchored"><a href="#type-info.fps_denominator" class="anchor"></a><code><span>fps_denominator : int;</span></code></li><li id="type-info.aspect_numerator" class="def record field anchored"><a href="#type-info.aspect_numerator" class="anchor"></a><code><span>aspect_numerator : int;</span></code></li><li id="type-info.aspect_denominator" class="def record field anchored"><a href="#type-info.aspect_denominator" class="anchor"></a><code><span>aspect_denominator : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Theora bitstream info.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_granule_shift"><a href="#val-default_granule_shift" class="anchor"></a><code><span><span class="keyword">val</span> default_granule_shift : int</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-data_buffer"><a href="#type-data_buffer" class="anchor"></a><code><span><span class="keyword">type</span> data_buffer</span><span> =
  <span><span>(int, <span class="xref-unresolved">Stdlib</span>.Bigarray.int8_unsigned_elt, <span class="xref-unresolved">Stdlib</span>.Bigarray.c_layout)</span>
    <span class="xref-unresolved">Stdlib</span>.Bigarray.Array1.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-yuv_buffer"><a href="#type-yuv_buffer" class="anchor"></a><code><span><span class="keyword">type</span> yuv_buffer</span><span> = </span><span>{</span></code><ol><li id="type-yuv_buffer.y_width" class="def record field anchored"><a href="#type-yuv_buffer.y_width" class="anchor"></a><code><span>y_width : int;</span></code></li><li id="type-yuv_buffer.y_height" class="def record field anchored"><a href="#type-yuv_buffer.y_height" class="anchor"></a><code><span>y_height : int;</span></code></li><li id="type-yuv_buffer.y_stride" class="def record field anchored"><a href="#type-yuv_buffer.y_stride" class="anchor"></a><code><span>y_stride : int;</span></code></li><li id="type-yuv_buffer.y" class="def record field anchored"><a href="#type-yuv_buffer.y" class="anchor"></a><code><span>y : <a href="#type-data_buffer">data_buffer</a>;</span></code></li><li id="type-yuv_buffer.u_width" class="def record field anchored"><a href="#type-yuv_buffer.u_width" class="anchor"></a><code><span>u_width : int;</span></code></li><li id="type-yuv_buffer.u_height" class="def record field anchored"><a href="#type-yuv_buffer.u_height" class="anchor"></a><code><span>u_height : int;</span></code></li><li id="type-yuv_buffer.u_stride" class="def record field anchored"><a href="#type-yuv_buffer.u_stride" class="anchor"></a><code><span>u_stride : int;</span></code></li><li id="type-yuv_buffer.u" class="def record field anchored"><a href="#type-yuv_buffer.u" class="anchor"></a><code><span>u : <a href="#type-data_buffer">data_buffer</a>;</span></code></li><li id="type-yuv_buffer.v_width" class="def record field anchored"><a href="#type-yuv_buffer.v_width" class="anchor"></a><code><span>v_width : int;</span></code></li><li id="type-yuv_buffer.v_height" class="def record field anchored"><a href="#type-yuv_buffer.v_height" class="anchor"></a><code><span>v_height : int;</span></code></li><li id="type-yuv_buffer.v_stride" class="def record field anchored"><a href="#type-yuv_buffer.v_stride" class="anchor"></a><code><span>v_stride : int;</span></code></li><li id="type-yuv_buffer.v" class="def record field anchored"><a href="#type-yuv_buffer.v" class="anchor"></a><code><span>v : <a href="#type-data_buffer">data_buffer</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>* A YUV buffer for passing uncompressed frames to and from the codec. * This holds a Y'CbCr frame in planar format. The CbCr planes can be * subsampled and have their own separate dimensions and row stride * offsets. Note that the strides may be negative in some * configurations. For theora the width and height of the largest plane * must be a multiple of 16. The actual meaningful picture size and * offset are stored in the <code>info</code> structure; frames returned by * the decoder may need to be cropped for display. * * All samples are 8 bits. Within each plane samples are ordered by * row from the top of the frame to the bottom. Within each row samples * are ordered from left to right.</p></div></div><h3 id="encoding"><a href="#encoding" class="anchor"></a>Encoding</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Encoder"><a href="#module-Encoder" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Encoder/index.html">Encoder</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Decoder"><a href="#module-Decoder" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Decoder/index.html">Decoder</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Skeleton"><a href="#module-Skeleton" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Skeleton/index.html">Skeleton</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
